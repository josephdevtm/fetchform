{"version":3,"file":"fetchform.js","sources":["../src/Errors.js","../src/edit/FetchForm.js"],"sourcesContent":["class FetchFormError extends Error {\r\n  constructor(message, status) {\r\n    super(message);\r\n    this.status = status;\r\n    this.name = 'FetchFormError';\r\n  }\r\n}\r\n\r\nexport { FetchFormError };","import { FetchFormError } from \"../Errors\"\r\n\r\nexport default class FetchForm {\r\n  /**\r\n   * Fetch form data\r\n   * @param {Object} form\r\n   * @param {Object} options\r\n   * @return {Object} Form data\r\n   * @memberof FetchForm\r\n   * @instance\r\n   * @example\r\n   * const form = document.querySelector('form')\r\n   * // options is optional\r\n   * const options = {\r\n   *   includeEmpty: false,\r\n   *   includeDisabled: false,\r\n   *   includeHidden: false\r\n   * }\r\n   * const fetchForm = new FetchForm(form, options)\r\n   * const data = fetchForm.getData()\r\n   * console.log(data)\r\n   * // { username: 'John Doe' }\r\n   */\r\n  constructor(form, options = {\r\n    includeDisabled: false,\r\n    includeEmpty: true,\r\n    includeHidden: true\r\n  }) {\r\n    this.form = form\r\n    this.options = options\r\n    this.data = this.getData()\r\n    this.submit = this.submit.bind(this)\r\n  }\r\n\r\n  /**\r\n   * Get form data\r\n   * @return {Object} Form data\r\n   * @throws {FetchFormError}\r\n   * @private\r\n   * @memberof FetchForm\r\n   * @instance\r\n   * @method getData\r\n   * @example\r\n   * const form = document.querySelector('form')\r\n   * const fetchForm = new FetchForm(form)\r\n   * const data = fetchForm.getData()\r\n   * console.log(data)\r\n   * // {\r\n   * //   \"name\": \"John Doe\",\r\n   * //   \"email\": \"johndoe@example.com\",\r\n   * //   \"website\": \"http://example.com\",\r\n   * //   \"age\": \"25\"\r\n   * // }\r\n   */\r\n\r\n  getData() {\r\n    const data = {}\r\n    const form = this.form\r\n    const options = this.options\r\n    const elements = form.elements\r\n\r\n    for (let i = 0; i < elements.length; i++) {\r\n      let element = elements[i]\r\n\r\n      data[element.name] = this.val(element)\r\n\r\n      if (options.includeEmpty === false && data[element.name] === '') {\r\n        delete data[element.name]\r\n      }\r\n\r\n      if (options.includeDisabled === false && element.disabled) {\r\n        delete data[element.name]\r\n      }\r\n\r\n      if (options.includeHidden === false && element.type === 'hidden') {\r\n        delete data[element.name]\r\n      }\r\n    }\r\n\r\n    return data\r\n  }\r\n\r\n  /**\r\n   * listener on submit form\r\n   * @param {Object} element\r\n   * @return {String} Value\r\n   * @private\r\n   * @memberof FetchForm\r\n   * @instance\r\n   * @method submit\r\n   * @example\r\n   * const form = document.querySelector('form')\r\n   * const fetchForm = new FetchForm(form)\r\n   * fetchForm.submit((event) => {\r\n   *  event.preventDefault()\r\n   *  const data = fetchform.getData()\r\n   * })\r\n   */\r\n  submit(callback) {\r\n    const form = this.form\r\n\r\n    form.onsubmit = callback\r\n  }\r\n\r\n  /**\r\n   * Get value of element\r\n   * @param {Object} element\r\n   * @return {String} Value\r\n   * @private\r\n   * @memberof FetchForm\r\n   * @instance\r\n   * @method val\r\n   * @example\r\n   * const form = document.querySelector('form')\r\n   * const input = form.elements.username\r\n   * const fetchForm = new FetchForm(form)\r\n   * const value = fetchForm.val(input)\r\n   * console.log(value)\r\n   * // \"John Doe\"\r\n   */\r\n  val(element) {\r\n    if (element.tagName === 'SELECT') {\r\n      return this.valSelect(element)\r\n    } else if (element.tagName === 'INPUT') {\r\n      return this.valInput(element)\r\n    } else if (element.tagName === 'TEXTAREA') {\r\n      return this.valTextarea(element)\r\n    } else {\r\n      throw new FetchFormError(`Unknown element type: ${element.tagName}`)\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get value of select element\r\n   * @param {Object} element\r\n   * @return {String} Value\r\n   * @private\r\n   * @memberof FetchForm\r\n   * @instance\r\n   * @method valSelect\r\n   * @example\r\n   * const form = document.querySelector('form')\r\n   * const fetchForm = new FetchForm(form)\r\n   * const value = fetchForm.valSelect(element)\r\n   * console.log(value)\r\n   * // [\"John Doe\"]\r\n   */\r\n  valSelect(element) {\r\n    const options = element.options\r\n    const values = []\r\n\r\n    for (let i = 0; i < options.length; i++) {\r\n      let option = options[i]\r\n\r\n      if (option.selected) {\r\n        values.push(option.value)\r\n      }\r\n    }\r\n\r\n    return values\r\n  }\r\n\r\n  /**\r\n   * Get value of input element\r\n   * @param {Object} element\r\n   * @return {String} Value\r\n   * @private\r\n   * @memberof FetchForm\r\n   * @instance\r\n   * @method valInput\r\n   * @example\r\n   * const form = document.querySelector('form')\r\n   * const fetchForm = new FetchForm(form)\r\n   * const value = fetchForm.valInput(element)\r\n   * console.log(value)\r\n   * // \"John Doe\"\r\n   */\r\n  valInput(element) {\r\n    if (element.type === 'checkbox') {\r\n      return element.checked\r\n    } else if (element.type === 'radio') {\r\n      return this.valRadio(element)\r\n    } else {\r\n      return element.value\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get value of radio element\r\n   * @param {Object} element\r\n   * @return {String} Value\r\n   * @private\r\n   * @memberof FetchForm\r\n   * @instance\r\n   * @method valRadio\r\n   * @example\r\n   * const form = document.querySelector('form')\r\n   * const gender = form.elements.gender;\r\n   * const fetchForm = new FetchForm(form)\r\n   * const value = fetchForm.valRadio(gender)\r\n   * console.log(value)\r\n   * // \"male\"\r\n   */\r\n  valRadio(element) {\r\n    const name = element.name\r\n    const radios = this.form.querySelectorAll(`input[name=\"${name}\"]`)\r\n    for (let i = 0; i < radios.length; i++) {\r\n      const radio = radios[i]\r\n      if (radio.checked) {\r\n        return radio.value\r\n      }\r\n    }\r\n    return null\r\n  }\r\n\r\n  /**\r\n   * Get value of textarea element\r\n   * @param {Object} element\r\n   * @return {String} Value\r\n   * @private\r\n   * @memberof FetchForm\r\n   * @instance\r\n   * @method valTextarea\r\n   * @example\r\n   * const form = document.querySelector('form')\r\n   * const fetchForm = new FetchForm(form)\r\n   * const value = fetchForm.valRadio(element)\r\n   * console.log(value)\r\n   * // \"Hello world\"\r\n   */\r\n  valTextarea(element) {\r\n    return element.value\r\n  }\r\n}"],"names":["super","const","let"],"mappings":"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"}